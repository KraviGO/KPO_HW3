# AntiPlagiarism System

---

## **Описание проекта**

Данный проект представляет собой микросервисную систему для проверки текстовых работ на плагиат. Архитектура построена по принципам **Microservices + API Gateway**, с использованием контейнеризации через **Docker** и **Docker Compose**.

Система позволяет:

- загружать файлы и метаданные работ;

- сохранять их в отдельном сервисе хранения;

- выполнять анализ текста на дубликаты;

- генерировать word cloud для анализа содержимого;

- обеспечивать взаимодействие сервисов через HTTP.

  

------



## **Архитектура системы**

Проект состоит из следующих компонентов:

### **1. File Storage Service**

Сервис хранения файлов и информации о работах.

**Ответственность:**

- загрузка файлов;
- хранение файлов на файловой системе контейнера;
- хранение метаданных файлов и работ в базе данных;
- предоставление API для получения файлов другими сервисами.



------



### **2. File Analysis Service**

Сервис анализа загруженных файлов.

**Ответственность:**

- получение файлов из File Storage Service;
- извлечение текста;
- проверка на дубликаты по хэшу;
- генерация word cloud;
- сохранение результатов анализа.



------



### **3. API Gateway**

Единая точка входа в систему.

**Ответственность:**

- маршрутизация HTTP-запросов к соответствующим микросервисам;

- скрытие внутренней структуры системы от клиента;

  

------



### **4. Базы данных**

Каждый сервис имеет собственную изолированную базу данных.

- storage-db — база данных File Storage Service
- analysis-db — база данных File Analysis Service

Обе базы работают в отдельных контейнерах PostgreSQL 16.



------



## **Взаимодействие сервисов**

- File Analysis Service обращается к File Storage Service по HTTP для получения файлов.
- API Gateway проксирует клиентские запросы к нужным сервисам.
- Все сервисы взаимодействуют внутри Docker-сети по DNS-именам контейнеров.



------



## **Docker-архитектура**

Проект разворачивается с помощью docker-compose.

Используются:

- отдельные контейнеры для каждого сервиса;
- отдельные контейнеры для каждой базы данных;
- volume’ы для сохранения данных PostgreSQL;
- healthcheck’и для корректного порядка запуска сервисов.



------



## **Swagger**

Swagger доступен **на уровне отдельных сервисов**, так как API Gateway выполняет только проксирование:

- http://localhost:5100/swagger
- http://localhost:5200/swagger



---



## **Запуск проекта**



### **1. Требования**

- Docker
- Docker Compose

### **2. Запуск**

В корне проекта выполнить:

```
docker compose up --build
```

После запуска будут доступны:

| **Сервис**            | **URL**               |
| --------------------- | --------------------- |
| File Storage Service  | http://localhost:5100 |
| File Analysis Service | http://localhost:5200 |
| API Gateway           | http://localhost:5777 |





Отлично, теперь можно описать **точно и технично**, опираясь на реальный код. Вот готовый **небольшой кусок README**, который можно вставлять как есть.



------



## **Дополнительные моменты реализации**



### **API Gateway**

В качестве API Gateway используется **YARP ** — официальный reverse proxy от Microsoft.

Gateway выступает единой точкой входа в систему и отвечает за маршрутизацию входящих HTTP-запросов к соответствующим микросервисам внутри Docker-сети.



---



### **Извлечение текста из файлов (Text Extraction)**

Для анализа содержимого файлов реализован модуль **TextExtraction**, который извлекает текст в зависимости от формата файла. Определение формата происходит по расширению файла, после чего применяется соответствующий механизм обработки:

- **.txt** — прямое чтение текста через StreamReader
- **.md**  — чтение файла и преобразование Markdown в обычный текст с помощью библиотеки **Markdig**
- **.docx** — извлечение текста из документа с использованием **NPOI (XWPF)**
- **.pdf** — извлечение текста постранично с помощью библиотеки **UglyToad.PdfPig**

Вся логика инкапсулирована в интерфейсе ITextExtractor и его реализации TextExtractor.



------



### **Генерация облака слов**

Для визуализации результатов анализа используется внешний HTTP-сервис **QuickChart**.

На основе извлечённого текста формируется запрос к API сервиса, который возвращает **ссылку на страницу с готовым облаком слов**.

Особенности реализации:

- текст ограничивается по длине (до 4000 символов) для корректной работы API
- результатом генерации является **URL**, ведущий на страницу с визуализацией
- ссылка сохраняется и возвращается как часть результата анализа

Таким образом, вместо хранения изображений внутри сервиса используется внешний сервис визуализации, что упрощает инфраструктуру и снижает нагрузку.

